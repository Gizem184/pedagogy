{% extends "base.html" %}

{% block content %}
    <script src=" {{ url_for('static', filename='js/vega.min.js') }} "></script>
    <script src=" {{ url_for('static', filename='js/vega-lite.js') }} "></script>
    <script src=" {{ url_for('static', filename='js/vega-embed.min.js') }} "></script>

    <!-- TODO: Use a dictionary instead of separate objects -->
    <div class="jumbotron">
        <div class="row">
            <div class="col-md-6 col-lg-4 col-sm-6">
                <h4 class="display-4 text-center">{{ personstats['totalstud'] }} </h4>
                <p class="text-center">Number of Students</p>
            </div>
            <div class="col-md-6 col-lg-4 col-sm-6">
                <h4 class="display-4 text-center">{{ personstats['totalhours'] }}</h4>
                <p class="text-center">Total Number of Hours</p> 
            </div>
            <div class="col-md-6 col-lg-4 col-sm-6">
                <h4 class="display-4 text-center">{{ personstats['totalstud'] }} </h4>
                <p class="text-center">Total Number of Students</p>
            </div>
        </div>
   </div> 
   <div class="row mt-2">
       <div class="col-md-12 col-lg-5 col-sm-12">
            <h4>Some Title</h4>
       </div>
       <div class="col-md-12 col-lg-7 col-sm-12">
            <div class="plot" id="vis_accomp_1"></div>
       </div>
   </div>

    <p>You're looking at performance metrics for: 
        {{ personstats['employee']['email'] }}, joined on {{ personstats['employee']['join_date'] }}</p>



    <div class="plot" id="vis_accomp_2"></div>
    

    <h4>Category Breakdown</h4>
    {% for gr in personstats['grped'] %}
        {{ gr }}: {{ personstats['grped'][gr]['count'] }} | {{ (personstats['grped'][gr]['students']) }} students. <br>
    {% endfor %}
    
    <hr>

    <h2>Workshop Timeline</h2>
    <div class="plot" id="vis_accomp_3"></div>
    {% for workshop in personstats['workshops'] %}
        <div>
            {{ workshop.workshop_start }}<br>    
            {{ workshop.workshop_name }}: <b> {{ workshop.workshop_category }}</b> <br/>
            <small> {{ workshop.workshop_venue }} | {{ workshop.class_size }} students | {{ workshop.workshop_hours }} hours </small>
        </div>
        <br>
    {% endfor %}

    <hr>

    <h2>Notable Comments</h2>
    {% for response in personstats['responses'] %}
            {{ response.satisfaction_score }} | {{ response.comments }}<br/>
    {% endfor %}
    
    <hr>
    <script type="text/javascript">
        function parse(url, div) {
            var opt = {
              mode: "vega-lite",
              renderer: "svg",
              actions: {export: false, source: false, editor: false}
            }; 
        //var spec = "https://raw.githubusercontent.com/vega/vega/master/docs/examples/bar-chart.vg.json";
    
            vegaEmbed(div, url, opt).then(function(result) {
              // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
            }).catch(console.error);
        }
        parse("/data/class_size_vs", "#vis_accomp_1")
        parse("/data/class_size_hours", "#vis_accomp_2")
        parse("/data/accum_personal", "#vis_accomp_3")
    </script>

{% endblock %}
